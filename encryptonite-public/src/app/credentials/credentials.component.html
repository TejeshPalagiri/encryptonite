<div class="header">
    <h2>Credentials</h2>
</div>
<div class="list-container">
    <ul class="w-100 list-header">
        <li class="w-15">Name</li>
        <li class="w-20">Domain</li>
        <li class="w-15">Username</li>
        <li class="w-10">Password</li>
        <li class="w-15">Last Accessed</li>
        <li class="w-10">Status</li>
        <li class="w-10">Actions</li>
    </ul>
    <ul class="w-100 list-data" *ngFor="let credential of credentials; let i = index;">
        <li class="w-15 ellipsis">{{ credential.name }}</li>
        <li class="w-20 ellipsis"><a href="{{credential.domain_url}}" class="ellipsis" target="_blank"> {{ credential.domain_url }} </a></li>
        <li class="w-15 ellipsis" style="cursor: pointer;" (click)="copyToClipboard(credential, 'username')"> <span class="clipboard ellipsis">{{ credential.user_name }}<i class='bx bx-copy' style='margin-left: 5px;'></i></span></li>
        <li class="w-10 ellipsis" style="cursor: pointer;" (click)="copyToClipboard(credential, 'password')"> <span class="clipboard ellipsis">xxxxxxxxx<i class='bx bx-copy'  style='margin-left: 5px;'></i></span></li>
        <li class="w-15 ellipsis"> {{ credential.last_accessed_at }}</li>
        <li class="w-10 ellipsis">{{ credential.status === true ? 'Active' : 'Deactive'  }}</li>
        <li class="w-10 action-btns">
            <button (click)="onEdit(credential)"> <i class='bx bxs-edit'></i> </button>
            <button (click)="selectedCredential=credential; selectedCredential.index=i;isDeleteVisible = true;"> <i class='bx bx-trash' style="color: red;"></i> </button>
        </li>
    </ul>
</div>
<div class="add-btn">
    <button (click)="onOpenAddCredentials()"><i class='bx bxs-plus-circle'></i></button>
</div>

<!-- Creeate / Update creedential modal -->
<nz-modal [(nzVisible)]="viewAddCredentials" nzTitle="Create Credentials" [nzFooter]="modalFooter">
    <ng-container *nzModalContent>
        <form nz-form [formGroup]="credentialForm">
            <!-- name -->
            <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="name">Name</nz-form-label>
            <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="The input is not valid name!">
                <input nz-input formControlName="name" id="name" placeholder="AWS Console" />
            </nz-form-control>
            </nz-form-item>
            <!-- Domain - url -->
            <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="website" nzRequired>Website</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input website url!">
                <input nz-input id="website" formControlName="domain_url" placeholder="https://example.com" />
                </nz-form-control>
            </nz-form-item>
            <!-- username -->
            <nz-form-item>
                <nz-form-label
                    [nzSm]="6"
                    [nzXs]="24"
                    nzFor="user_name"
                    nzRequired
                    nzTooltipTitle="Your user name or email used to login."
                >
                    <span>Username</span>
                </nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input your Username !">
                    <input nz-input id="user_name" formControlName="user_name" placeholder="alice95" />
                </nz-form-control>
            </nz-form-item>
            <!-- password -->
            <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="password" nzRequired>Password</nz-form-label>
            <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Please input your password!">
                <input
                nz-input
                type="password"
                id="password"
                formControlName="password"
                placeholder="*********"
                />
            </nz-form-control>
            </nz-form-item>
            
        </form>
    </ng-container>
    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="onCancel()">Close</button>
        <button nz-button nzType="primary" (click)="onSubmitForm(undefined)" [disabled]="credentialForm.invalid" *ngIf="!selectedCredential">Create Credential</button>
        <button nz-button nzType="primary" (click)="onSubmitForm(selectedCredential._id)" [disabled]="credentialForm.invalid" *ngIf="selectedCredential && selectedCredential._id" >Update Credential</button>
    </ng-template>
</nz-modal>

<!-- Deletee confirmation modal -->
<nz-modal
      [(nzVisible)]="isDeleteVisible"
      nzTitle="Delete"
      (nzOnCancel)="onCancel()"
      (nzOnOk)="handleDeleteOk(selectedCredential._id)"
      [nzOkLoading]="isOkLoading"
    >
      <p *nzModalContent>Are you sure want to delete the credential?</p>
</nz-modal>